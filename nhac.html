<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title -->
    <title>One Music - Modern Music HTML5 Template</title>

    <!-- Favicon -->
    <link rel="icon" href="img/core-img/favicon.ico">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css" integrity="sha512-CIYsJUa3pr1eoXlZFroEI0mq0UIMUqNouNinjpCkSWo3Bx5NRlQ0OuC6DtEB/bDqUWnzXc1gs2X/g52l36N5iw==" crossorigin="anonymous" />
    <link rel="stylesheet" type="text/css" href="css/nhac.css">
</head>
<body>
	
	<!-- ##### Header Area Start ##### -->
	<header class="header-area">
	    <!-- Navbar Area -->
	    <div class="oneMusic-main-menu">
	        <div class="classy-nav-container breakpoint-off">
	            <div class="container">
	                <!-- Menu -->
	                <nav class="classy-navbar justify-content-between" id="oneMusicNav">

	                    <!-- Nav brand -->
	                    <a href="index.html" class="nav-brand"><img src="img/core-img/logo.png" alt=""></a>

	                    <!-- Navbar Toggler -->
	                    <div class="classy-navbar-toggler">
	                        <span class="navbarToggler"><span></span><span></span><span></span></span>
	                    </div>

	                    <!-- Menu -->
	                    <div class="classy-menu">

	                        <!-- Close Button -->
	                        <div class="classycloseIcon">
	                            <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
	                        </div>

	                        <!-- Nav Start -->
	                        <div class="classynav">
	                            <ul>
	                                <li><a href="index.html">Trang chủ</a></li>
                                    <li><a href="albums-store.html">Albums</a></li>
                                    <li><a href="dangnhac.html">Đăng nhạc</a></li>
                                    <li><a href="event.html">Sự kiện</a></li>
                                    <li><a href="blog.html">Tin tức</a></li>
                                    <li><a href="contact.html">Liên hệ</a></li>
	                            </ul>

	                            <!-- Login/Register & Cart Button -->
	                            <div class="login-register-cart-button d-flex align-items-center" id="check_session">
	                                <!-- Login/Register -->
	                                <div class="login-register-btn mr-50">
	                                    <a href="login.html" id="loginBtn">Đăng nhập</a>
	                                    <span style="color: white !important;">&ensp;/&ensp;</span>
	                                    <a href="register.html" id="registerBtn">Đăng kí</a>
	                                </div>

	                                <!-- Cart Button -->
	                                
	                            </div>
	                            <div class="motphantu">
                                    <div class="login-register-cart-button d-flex align-items-center" id="logined" ></div>
                                    <div class="option-list">
                                        <ul class="list-group">
                                            <li class="list-group-item"><button style="border:none;background:none;" onclick="trangCaNhan()">Trang cá nhân</button></li>
                                            <li class="list-group-item"><button style="border:none;background:none;" onclick="logout()">Đăng xuất</button></li>
                                        </ul>
                                    </div>
                                </div>
	                        </div>
	                        <!-- Nav End -->
	                        
	                    </div>
	                </nav>
	            </div>
	        </div>
	    </div>
	</header>
	<!-- ##### Header Area End ##### -->

	<!-- ##### Breadcumb Area Start ##### -->
	<section class="breadcumb-area bg-img bg-overlay" style="background-image: url(img/bg-img/breadcumb3.jpg);">
	   
	</section>
	<!-- ##### Breadcumb Area End ##### -->


	<section class="nhac-session" style="padding: 50px 0;">
		<div class="nhac-descript-wrapper container">
			<div class="nhac-descript">
				<div class="nhac-des">
					<div class="aplay-wrap">
                        <div id="aplayer"></div>
                    </div>
					<div class="nhac-info">
                        <div class="baihat-name">
                            <h3 id="songName">Tên bài hát</h3>
                        </div>
						<div class="author-name">
							<p id="authorName">Tên tác giả</p>
						</div>
						<!-- <div class="song-price">
							<p id="songPrice"></p>
						</div> -->
                        <div class="baihat-description">
                            <div class="color luotnghe">
                                <p><i class="fas fa-play">&ensp;</i>200k</p>
                            </div>
                            <div class="color ngaydang">
                                <p><i class="far fa-clock">&ensp;</i> <span id="id_ngaydang">Sep 26, 2020</span></p>
                            </div>
                        </div>
                        <!-- <div class="color giabeat">
                            <p><i class="fas fa-dollar-sign">&ensp;</i> <span id="songPrice"></span></p>
                        </div> -->
                        <div class="baihat-action">
                            <button type="button" id="btnSongPrice" onclick="checkUserAcc()" class="btn btn-info btn-lg"><i class="fas fa-shopping-cart"></i>&ensp; <span id="songPrice"></span></button>
                            
                            <button class="btn-group btn-like">
                                <i class="far fa-heart"></i>
                                <!-- <span>5.2k</span> -->
                            </button>
                            <button class="btn-group btn-add">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="btn-group btn-download">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
					</div>
				</div>
			</div>	
		</div>
	</section>

    <section class="nhackhac">
        <div class="list-nhackhac container">
            <ul class="list-group list-group-flush" id="listnhackhac">
              <li class="list-group-item">Cras justo odio</li>
            </ul>
        </div>
    </section>
	
    <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Cam kết người mua</h5>

            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            ĐIỀU KHOẢN VÀ CHÍNH SÁCH CỦA ONE SOUND
            Những điều khoản sử dụng, vì chúng có thể được sửa đổi bởi ONE SOUND, áp dụng cho tất cả khách truy cập vào trang Web, cả bây giờ và trong tương lai. Nếu bạn không đồng ý với tất cả các điều khoản, điều kiện, thực tiễn và chính sách được quy định dưới đây, không truy cập hoặc sử dụng bất kỳ Website ONE SOUND S hoặc bất kỳ trang của nó.

            Bạn thừa nhận rằng các điều khoản trong hợp đồng giữa Bạn và ONE SOUND, đôi khi là hợp đồng điện tử và không có chữ ký của Bạn và ONE SOUND, nhưng một khi bạn đã chấp thuận dịch vụ thì hợp đồng điện tử vẫn có giá trị pháp lý như hợp đồng được ký kết giữa Bạn và ONE SOUND.
            Về tác giả:
            1.  Bạn đồng ý không cung cấp (a) Giấy phép, cấp phép, chuyển nhượng, chuyển nhượng hoặc phân phối cho bất kỳ bên thứ ba, trừ khi được chấp thuận bằng văn bản của ONE SOUND và theo điều khoản quy định; (b) sử dụng Dịch vụ cho mục đích trái pháp luật, bao gồm nhưng không giới hạn để vi phạm quyền sở hữu trí tuệ của bất cứ người nào, hoặc gửi thư rác hoặc các tin nhắn khác trùng lặp hoặc không được vi phạm pháp luật, (c) sử dụng Dịch vụ để tải lên, liên kết đến, gửi hoặc lưu trữ bất kỳ nội dung trái pháp luật, phân biệt chủng tộc, hận thù, khiêu dâm, phân biệt đối xử, hoặc có chứa bất kỳ loại virus  hoặc bất kỳ chươn trình tương tự khác có tác hại đến trang;
            2.  Bạn chịu trách nhiệm cho tất cả các thông tin, dữ liệu, văn bản, tin nhắn hoặc các tài liệu khác mà bạn gửi hoặc được truyền qua Dịch Vụ. Bạn chịu trách nhiệm cho việc duy trì mật tên đăng nhập và tài khoản của bạn, và hoàn toàn chịu trách nhiệm cho bất kỳ và tất cả các hoạt động diễn ra đăng nhập hoặc tài khoản của bạn. Bạn đồng ý và thừa nhận rằng đăng nhập của bạn chỉ có thể được sử dụng bởi một (1) người, và rằng bạn sẽ không chia sẻ một đăng nhập duy nhất giữa nhiều người. ONE SOUND không chịu trách nhiệm về bất kỳ điều khoản nào không được quy định trong quy định này.
            3.  Bạn đồng ý sẽ thông báo ngay cho ONE SOUND về bất kỳ trường hợp nào sử dụng trái phép tài khoản và mật khẩu của bạn hoặc bất kỳ các hành động phá vỡ hệ thống bảo mật nào.
            4.  Chúng tôi sẽ chia lợi nhuật khi có đơn hàng được thanh toán từ 3-5 ngày kể từ này giao dịch được hoàn thành. Mỗi bài hát chúng tôi sẽ thu 5% số tiền với mỗi bài hát được giao dịch thành công.
            Về người mua:
            1.  Lợi dụng ONE SOUND để thu thập thông tin của Người Sử Dụng, công bố thông tin, tư liệu về đời tư của Người Sử Dụng khác. Đặt thành viên theo tên của danh nhân, tên các vị lãnh đạo của Đảng và Nhà nước, tên của cá nhân, tổ chức tội phạm, phản động, khủng bố hoặc tài khoản có ý nghĩa không lành mạnh, trái với thuần phong mỹ tục.
            2.  Cản trở trái pháp luật, gây rối, phá hoại hệ thống máy chủ; Cản trở việc truy cập thông tin và sử dụng các dịch vụ hợp pháp trên ONE SOUND.
            3.  Người Sử Dụng có thể sẽ chịu trách nhiệm bồi thường thiệt hại dân sư, khả năng bị phạt vi phạm hành chính hoặc bị truy tố trách nhiệm hình sự nếu có hành vi vi phạm quyền tác giả hoặc quyền liên quan khi sử dụng ONE SOUND.
            Về  ONE SOUND:
            1.  Trong việc cung cấp dịch vụ của bạn ONE SOUND sẽ duy trì các biện pháp bảo vệ hành chính, vật lý và kỹ thuật thích hợp để bảo vệ an ninh, bảo mật và tính toàn vẹn của dữ liệu của bạn và các dữ liệu cá nhân của bạn cho người dùng cuối. Những biện pháp bảo vệ bao gồm mã hóa dữ liệu của bạn trong truyền tải (sử dụng SSL hoặc công nghệ tương tự), trừ một số tích hợp bên ngoài thứ ba mà không hỗ trợ mã hóa, mà bạn có thể liên kết với Dịch vụ theo sự lựa chọn của bạn. Bạn đồng ý rằng ONE SOUND có thể truy cập thông tin tài khoản của bạn để đáp ứng với yêu cầu dịch vụ của bạn. Chúng tôi mọi thông tin cá nhân không được bảo mật và không tiết lộ cho bất kỳ bên thứ ba nào dưới mọi hình thức trừ khi có yêu cầu hoặc bắt buộc của pháp luật hoặc được sự đồng ý của Bạn, hoặc theo các điều khoản của Chính sách Bảo mật ONE SOUND.
            2.  Chúng tôi cam kết sẽ không sử dụng thông tin của người dùng cho mục đích khác và phát tán nhạc đi các nơi khác.
            3.  Trong quá trình sử dụng ONE SOUND, nếu bạn vi phạm bất kỳ quy định nào trong Thỏa Thuận này, chúng tôi có toàn quyền, ngay lập tức và không cần thông báo trước cho bạn, chấm dứt, xóa bỏ tài khoản của bạn mà không phải chịu bất cứ trách nhiệm nào đối với bạn, đồng thời tùy theo mức độ vi phạm, chúng tôi có thể từ chối việc bạn đăng ký để sử dụng các dịch vụ khác của ONE SOUND.

            Điều khoản này sẽ được điều chỉnh bởi pháp luật của nước CHXHCN Việt Nam. Hai bên sẽ cùng nhau phối hợp, thương lượng và giải quyết các tranh chấp (nếu có) trong quá trình thực hiện hợp đồng. Trong quá trình thực hiện, nếu có phát sinh bổ sung hoặc sửa đổi bản hợp đồng này đều phải được sự đồng ý bằng văn bản của hai bên. Trường hợp phát sinh bất đồng mà hai bên không giải quyết được bằng thương lượng thì sẽ đưa ra Tòa án kinh tế Tp. Hà Nội phân xử, quyết định của Tòa án là quyết định cuối cùng buộc hai bên phải thực hiện và án phí sẽ do bên có lỗi chịu.

          </div>
          <div class="modal-footer"><div id="paypal-button-container"></div></div>
        </div>
      </div>
      
    </div>
    
        <footer class="footer-area" style="margin-top: 40px;">
            <div class="container">
                <div class="row d-flex flex-wrap align-items-center">
                    <div class="col-12 col-md-6">
                        <a href="#"><img src="img/core-img/logo.png" alt=""></a>
                        <p class="copywrite-text"><a href="#"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
    Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i>
    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="footer-nav">
                            <ul>
                                <li><a href="#">Trang chủ</a></li>
                                <li><a href="#">Sự kiện</a></li>
                                <li><a href="#">Tin tức</a></li>
                                <li><a href="#">Liên hệ</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Popper js -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <!-- Bootstrap js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <!-- All Plugins js -->
    <script src="js/plugins/plugins.js"></script>
    <!-- Active js -->
    <script src="js/active.js"></script>
    <script src="js/api.js"></script>
    <script src="js/main.js"></script>
    <script src="js/file_hander.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js" integrity="sha512-RWosNnDNw8FxHibJqdFRySIswOUgYhFxnmYO3fp+BgCU7gfo4z0oS7mYFBvaa8qu+axY39BmQOrhW3Tp70XbaQ==" crossorigin="anonymous"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AUV5uLIhYItXSWADnSGPLvtvctgrX2JEUw_RfsyjfkpiEGsBCfBXw6PIXe1M-HysNBq2-ckt0GfAOVtG&currency=USD"></script>

    <!-- Optional JavaScript -->
    <script type="text/javascript">
        function checkUserAcc(){
            if (checkSession()) {
                $('#exampleModalLong').modal('show');
            }else{
                window.location.assign('login.html');
            }
        }

        

        api_layNhacTheoId(getUrlParameter('id')).done(result => {
            $('#songName').html(result.data.name);
            $('#songPrice').html('$'+result.data.price);
            $('#authorName').html(result.data.creator.name);
            $('#id_ngaydang').html(result.data.createAt);

            api_UserDetail(result.data.creator.id).done(function(res){
                var html = "";
                var count = 1;
                $.each(res.data.songs, function(i, nhac){
                    if (nhac.id != getUrlParameter('id')) {
                        html += '<li class="list-group-item" style="border:none !important; border-bottom:1px solid rgb(0,0,0,.125) !important">';
                        html += '<span style="margin:15px;">'+count+'</span>';
                        html += '<span><a href="nhac.html?id='+nhac.id+'">'+nhac.name+' - </a></span>';
                        html += '<span style="">'+result.data.creator.name+'</span>';
                        html += '</li>';
                        count ++;
                    }
                });
                $('#listnhackhac').html(html);
            });

            if(result.data.creator.id == sessionStorage.getItem('user_id')) {
                $("#btnSongPrice").attr("disabled", 'disabled');
            }

            new APlayer({
                    container: document.getElementById('aplayer'),
                    mini: true,
                    audio:[{
                        url: get_file(result.data.demo),
                        cover:'https://yt3.ggpht.com/34TzY9bD7E-juYZsCDpj2jW6GzC9JkZOuPBF__3KOdjsYc4YSCFCgz9iT0YAjG6ulcScsijv=s900-c-k-c0x00ffffff-no-rj'
                    }]
                })

            // Render the PayPal button into #paypal-button-container
            paypal.Buttons({
                style: {
                  shape: 'rect',
                  color: 'gold',
                  layout: 'horizontal',
                  label: 'paypal',
                  
                },
                // Set up the transaction
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            amount: {
                                value: result.data.price
                            },
                            description: 'Beat '+result.data.name+' of OneSound' //co the truyen id or name bai hat vao de luu db khi thanh toan xong
                        }]
                    });
                },

                // Finish the transaction
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        // Show a success message to the buyer
                        alert('Transaction completed by ' + details.payer.name.given_name + '!');
                        console.log(details);
                        //goi api luu Transaction vao db
                        //...
                        api_themTransactionThanhToanThanhCong(result.data.id, sessionStorage.getItem("user_id")).done(function(result){
                            if (result.data == null) {
                                toastr.error(result.message);
                            }else{
                                toastr.success(result.message);
                            }
                        });
                        api_updateNhacDaThanhToan(result.data.id).done(
                            function(result){
                                if (result.data == null) {
                                    toastr.error(result.message);
                                }else{
                                    toastr.success(result.message);
                                }
                            })
                        });
                }
            }).render('#paypal-button-container');
        })
    </script>
</body>
</html> 
